<view><uni-popup wx:if="{{C}}" class="r" u-s="{{['d']}}" u-r="smsPopup" bindchange="{{B}}" u-i="1875345c-0" bind:__l="__l" u-p="{{C}}"><view class="sms-manager"><view class="sms-manager--header mb">群发短信</view><uni-forms wx:if="{{v}}" class="r" u-s="{{['d']}}" u-r="smsForm" u-i="1875345c-1,1875345c-0" bind:__l="__l" u-p="{{v}}"><uni-forms-item wx:if="{{a}}" u-s="{{['d']}}" u-i="1875345c-2,1875345c-1" bind:__l="__l" u-p="{{d}}"><view wx:if="{{b}}">当前已选择{{c}}人</view><view wx:else>全部用户</view><view class="sms-data-tip">如需给指定用户发送，请在列表选择要发送的用户。</view></uni-forms-item><uni-forms-item wx:else u-s="{{['d']}}" u-i="1875345c-3,1875345c-1" bind:__l="__l" u-p="{{f||''}}"><view>当前已选择{{e}}个标签</view><view class="sms-data-tip">如标签关联的用户没有绑定手机号，将不会发送短信。</view></uni-forms-item><uni-forms-item wx:if="{{i}}" u-s="{{['d']}}" u-i="1875345c-4,1875345c-1" bind:__l="__l" u-p="{{i}}"><uni-easyinput wx:if="{{h}}" u-i="1875345c-5,1875345c-4" bind:__l="__l" bindupdateModelValue="{{g}}" u-p="{{h}}"/></uni-forms-item><uni-forms-item wx:if="{{m}}" u-s="{{['d']}}" u-i="1875345c-6,1875345c-1" bind:__l="__l" u-p="{{m}}"><unicloud-db wx:if="{{l}}" class="r" u-s="{{['d']}}" u-r="template_db" u-i="1875345c-7,1875345c-6" bind:__l="__l" u-p="{{l}}"><view wx:for="{{j}}" wx:for-item="v0" wx:key="i" slot="{{v0.j}}"><block wx:if="{{v0.a}}"><view wx:if="{{v0.b}}"><uni-data-select wx:if="{{v0.f}}" class="type m" bindchange="{{v0.c}}" u-i="{{v0.d}}" bind:__l="__l" bindupdateModelValue="{{v0.e}}" u-p="{{v0.f}}"></uni-data-select><view class="sms-data-tip"> 导入短信模版参考<navigator class="a-link" href="https://uniapp.dcloud.net.cn/uniCloud/admin.html#群发短信" target="_blank">教程</navigator>；若有新的短信模版，可<text bindtap="{{v0.g}}" class="a-link">点此导入</text></view></view><view wx:else><button bindtap="{{v0.h}}" type="primary" style="width:120px" size="mini">上传短信模板</button><view class="sms-data-tip">当前未导入短信模板，请从dev.dcloud.net.cn的短信-<navigator href="https://dev.dcloud.net.cn/pages/sms/template" target="_blank">模板配置</navigator>中导出短信模版，并在此导入。教程<navigator href="https://uniapp.dcloud.net.cn/uniCloud/admin.html#batch-sms" target="_blank">详见</navigator></view></view></block><block wx:else> 模板加载中... </block></view></unicloud-db></uni-forms-item><uni-forms-item wx:if="{{n}}" u-s="{{['d']}}" u-i="1875345c-9,1875345c-1" bind:__l="__l" u-p="{{p}}"><view class="form-item-flex-center">{{o}}</view></uni-forms-item><uni-forms-item wx:if="{{q}}" u-s="{{['d']}}" u-i="1875345c-10,1875345c-1" bind:__l="__l" u-p="{{s}}"><view wx:for="{{r}}" wx:for-item="template" wx:key="g" class="sms-data-item"><uni-easyinput wx:if="{{template.c}}" class="field m" style="width:120px;flex:none" u-i="{{template.a}}" bind:__l="__l" bindupdateModelValue="{{template.b}}" u-p="{{template.c}}"/><uni-easyinput wx:if="{{template.f}}" class="value m" u-i="{{template.d}}" bind:__l="__l" bindupdateModelValue="{{template.e}}" u-p="{{template.f}}"/></view><view class="sms-data-tip">短信变量支持固定值和数据表查询两种方式；固定值如：各位同事，数据表查询如：{uni-id-users.username}；请注意，若使用数据表查询方式，目前仅支持查询 uni-id-users 表；并注意确保数据库中查询字段值不为空，否则短信将发送失败。</view></uni-forms-item></uni-forms><view class="uni-group"><button bindtap="{{w}}" class="uni-button">预览</button><button bindtap="{{x}}" class="uni-button" type="primary">提交</button></view></view><uni-icons wx:if="{{z}}" class="close" bindclick="{{y}}" u-i="1875345c-13,1875345c-0" bind:__l="__l" u-p="{{z}}"></uni-icons></uni-popup><uni-popup wx:if="{{H}}" class="r" u-s="{{['d']}}" u-r="previewPopup" u-i="1875345c-14" bind:__l="__l" u-p="{{H}}"><view class="sms-manager preview"><view class="sms-manager--header mb"><view>短信预览</view><view class="sub-title">仅预览第一条短信内容</view></view><view class="content"><view wx:for="{{D}}" wx:for-item="content">{{content.a}}</view><view class="length">短信字数：<text class="num">{{E}}</text>字</view></view><view class="tip"><view>说明：</view><view>若从数据表中查询，字段内容长度会影响总字数，短信字数＝短信签名字数+短信内容字数。</view><view>短信长度不超过70个字，按照一条短信计费；超过70个字，按照67字/条拆分成多条计费。</view></view><view class="uni-group"><button bindtap="{{F}}" class="uni-button">关闭</button></view></view></uni-popup></view>